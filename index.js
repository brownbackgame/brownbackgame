var DEBUG,FLAP,GAME_HEIGHT,GRAVITY,GROUND_HEIGHT,GROUND_Y,HEIGHT,OPENING,SCALE,SPAWN_RATE,SPEED,WIDTH,WebFontConfig,bg,bird,character,deadInvs,deadTubeBottoms,deadTubeTops,fallSnd,flapSnd,floor,gameOver,gameOverText,gameStarted,ground,hurtSnd,instText,invs,main,parent,score,scoreSnd,scoreText,swooshSnd,tubes,tubesTimer;DEBUG=!1,SPEED=160,GRAVITY=1100,FLAP=320,SPAWN_RATE=1/1200,OPENING=100,SCALE=1,WIDTH=288,GAME_HEIGHT=336,GROUND_Y=(HEIGHT=384)-(GROUND_HEIGHT=64),parent=document.querySelector("#screen"),gameOver=gameStarted=void 0,deadTubeTops=[],deadTubeBottoms=[],deadInvs=[],(tubesTimer=swooshSnd=fallSnd=hurtSnd=scoreSnd=flapSnd=gameOverText=instText=scoreText=score=ground=bird=invs=tubes=bg=null)===(character=window.localStorage.getItem("character"))&&(window.localStorage.setItem("character","ksu"),character=window.localStorage.getItem("character")),floor=Math.floor,WebFontConfig={google:{families:["Press+Start+2P::latin"]},active:main=function(){var addScore,create,flap,game,reset,setGameOver,spawntube,spawntubes,start,state;spawntube=function(openPos,flipped){var tube,tubeKey,tubeY;return tube=null,tubeKey=flipped?"tubeTop":"tubeBottom",tubeY=floor(flipped?openPos-OPENING/2-320:openPos+OPENING/2),0<deadTubeTops.length&&"tubeTop"===tubeKey?(tube=deadTubeTops.pop().revive()).reset(game.world.width,tubeY):0<deadTubeBottoms.length&&"tubeBottom"===tubeKey?(tube=deadTubeBottoms.pop().revive()).reset(game.world.width,tubeY):(tube=tubes.create(game.world.width,tubeY,tubeKey),game.physics.enable(tube,Phaser.Physics.ARCADE),tube.body.allowGravity=!1),tube.body.velocity.x=-SPEED,tube},spawntubes=function(){var inv,toptube,tubeY;tubes.forEachAlive(function(tube){tube.x+tube.width<game.world.bounds.left&&("tubeTop"===tube.key&&deadTubeTops.push(tube.kill()),"tubeBottom"===tube.key&&deadTubeBottoms.push(tube.kill()))}),invs.forEachAlive(function(invs){invs.x+invs.width<game.world.bounds.left&&deadInvs.push(invs.kill())}),tubeY=game.world.height/2+(Math.random()-.5)*game.world.height*.2,spawntube(tubeY),toptube=spawntube(tubeY,!0),0<deadInvs.length?inv=deadInvs.pop().revive().reset(toptube.x+toptube.width/2,0):((inv=invs.create(toptube.x+toptube.width/2,0)).width=2,inv.height=game.world.height,game.physics.enable(inv,Phaser.Physics.ARCADE),inv.body.allowGravity=!1),inv.body.velocity.x=-SPEED},addScore=function(_,inv){invs.remove(inv),score+=1,scoreText.setText(score),scoreSnd.play()},setGameOver=function(){var hiscore;gameOver=!0,0<bird.body.velocity.y&&(bird.body.velocity.y=100),bird.animations.stop(),bird.frame=1,instText.setText("TOUCH\nTO TRY AGAIN"),instText.renderable=!0,hiscore=(hiscore=window.localStorage.getItem("hiscore"))||score,hiscore=score>parseInt(hiscore,10)?score:hiscore,window.localStorage.setItem("hiscore",hiscore),gameOverText.setText("Brownback Wins!\n\nHIGH SCORE\n\n"+hiscore),gameOverText.renderable=!0,tubes.forEachAlive(function(tube){tube.body.velocity.x=0}),invs.forEach(function(inv){inv.body.velocity.x=0}),game.time.events.remove(tubesTimer),game.time.events.add(1e3,function(){return game.input.onTap.addOnce(function(){return reset(),swooshSnd.play()})}),hurtSnd.play()},flap=function(){gameStarted||start(),gameOver||(bird.body.gravity.y=0,bird.body.velocity.y=-100,game.add.tween(bird.body.velocity).to({y:-FLAP},25,Phaser.Easing.Bounce.In,!0).onComplete.add(function(){return bird.body.gravity.y=GRAVITY}),flapSnd.play())},create=function(){window.innerWidth,window.innerHeight,document.querySelector("#loading").style.display="none",Phaser.Canvas.setSmoothingEnabled(game.context,!1),game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,game.world.width=WIDTH,game.world.height=HEIGHT,bg=game.add.tileSprite(0,0,WIDTH,HEIGHT,"bg"),tubes=game.add.group(),invs=game.add.group(),bird=game.add.sprite(0,0,"bird"),game.physics.enable(bird,Phaser.Physics.ARCADE),bird.anchor.setTo(.5,.5),bird.body.collideWorldBounds=!0,(ground=game.add.tileSprite(0,GROUND_Y,WIDTH,GROUND_HEIGHT,"ground")).tileScale.setTo(SCALE,SCALE),(scoreText=game.add.text(game.world.width/2,game.world.height/4,"",{font:'16px "Press Start 2P"',fill:"#fff",stroke:"#430",strokeThickness:4,align:"center"})).anchor.setTo(.5,.5),(instText=game.add.text(game.world.width/2,game.world.height-game.world.height/4,"",{font:'8px "Press Start 2P"',fill:"#fff",stroke:"#430",strokeThickness:4,align:"center"})).anchor.setTo(.5,.5),(gameOverText=game.add.text(game.world.width/2,game.world.height/2,"",{font:'16px "Press Start 2P"',fill:"#fff",stroke:"#430",strokeThickness:4,align:"center"})).anchor.setTo(.5,.5),gameOverText.scale.setTo(SCALE,SCALE),flapSnd=game.add.audio("flap"),scoreSnd=game.add.audio("score"),hurtSnd=game.add.audio("hurt"),fallSnd=game.add.audio("fall"),swooshSnd=game.add.audio("swoosh"),game.input.onDown.add(flap),reset()},reset=function(){gameOver=gameStarted=!1,score=0,scoreText.setText("Thread\nBrownback's Cuts"),instText.setText("Try your best to avoid\nBrownback's pay cuts.\n\nTAP TO FLY"),gameOverText.renderable=!1,bird.body.allowGravity=!1,bird.reset(.3*game.world.width,game.world.height/2),bird.angle=0,bird.animations.play("fly"),tubes.removeAll(),invs.removeAll()},start=function(){bird.body.allowGravity=!0,bird.body.gravity.y=GRAVITY,tubesTimer=game.time.events.loop(1/SPAWN_RATE,spawntubes),scoreText.setText(score),instText.renderable=!1,gameStarted=!0},state={preload:function(){var assets;assets="ksu"===character?{spritesheet:{bird:["assets/characters/ksu.png",31,24]},image:{tubeTop:["assets/tube1.png"],tubeBottom:["assets/tube2.png"],ground:["assets/ground.png"],bg:["assets/bg.png"]},audio:{flap:["assets/sfx_wing.mp3"],score:["assets/sfx_point.mp3"],hurt:["assets/sfx_hit.mp3"],fall:["assets/sfx_die.mp3"],swoosh:["assets/sfx_swooshing.mp3"]}}:"ku"===character?{spritesheet:{bird:["assets/characters/ku.png",34,20]},image:{tubeTop:["assets/tube1.png"],tubeBottom:["assets/tube2.png"],ground:["assets/ground.png"],bg:["assets/bg.png"]},audio:{flap:["assets/sfx_wing.mp3"],score:["assets/sfx_point.mp3"],hurt:["assets/sfx_hit.mp3"],fall:["assets/sfx_die.mp3"],swoosh:["assets/sfx_swooshing.mp3"]}}:"wsu"===character?{spritesheet:{bird:["assets/characters/wsu.png",28,23]},image:{tubeTop:["assets/tube1.png"],tubeBottom:["assets/tube2.png"],ground:["assets/ground.png"],bg:["assets/bg.png"]},audio:{flap:["assets/sfx_wing.mp3"],score:["assets/sfx_point.mp3"],hurt:["assets/sfx_hit.mp3"],fall:["assets/sfx_die.mp3"],swoosh:["assets/sfx_swooshing.mp3"]}}:{spritesheet:{bird:["assets/characters/fhsu.png",24,23]},image:{tubeTop:["assets/tube1.png"],tubeBottom:["assets/tube2.png"],ground:["assets/ground.png"],bg:["assets/bg.png"]},audio:{flap:["assets/sfx_wing.mp3"],score:["assets/sfx_point.mp3"],hurt:["assets/sfx_hit.mp3"],fall:["assets/sfx_die.mp3"],swoosh:["assets/sfx_swooshing.mp3"]}},Object.keys(assets).forEach(function(type){Object.keys(assets[type]).forEach(function(id){game.load[type].apply(game.load,[id].concat(assets[type][id]))})})},create:create,update:function(){gameStarted?gameOver?(game.add.tween(bird).to({angle:90},100,Phaser.Easing.Bounce.Out,!0),bird.body.bottom>=GROUND_Y+3&&(bird.y=GROUND_Y-13,bird.body.velocity.y=0,bird.body.allowGravity=!1,bird.body.gravity.y=0)):(bird.angle=90*(FLAP+bird.body.velocity.y)/FLAP-180,bird.angle<-30&&(bird.angle=-30),80<bird.angle?(bird.angle=90,bird.animations.stop(),bird.frame=1):bird.animations.play(),game.physics.arcade.overlap(bird,tubes,function(){return setGameOver(),fallSnd.play()}),!gameOver&&bird.body.bottom>=GROUND_Y&&setGameOver(),game.physics.arcade.overlap(bird,invs,addScore)):(bird.y=game.world.height/2+8*Math.cos(game.time.now/200),bird.angle=0),gameOver||(ground.tilePosition.x-=game.time.physicsElapsed*SPEED)},render:function(){DEBUG&&(game.debug.renderSpriteBody(bird),tubes.forEachAlive(function(tube){game.debug.renderSpriteBody(tube)}),invs.forEach(function(inv){game.debug.renderSpriteBody(inv)}))}},game=new Phaser.Game(WIDTH,HEIGHT,Phaser.CANVAS,parent,state,!1,!1)}},function(){var s,wf;(wf=document.createElement("script")).src=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",wf.type="text/javascript",wf.async="true",(s=document.getElementsByTagName("script")[0]).parentNode.insertBefore(wf,s)}();